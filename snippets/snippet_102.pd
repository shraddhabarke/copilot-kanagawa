template <typename T, auto N> inline optional<T> last_valid(optional<T>[N] x) { return reduce(selecting(on2nd(not(Opt::is_valid<T>))), x); }